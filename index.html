<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å - –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            display: flex;
            gap: 24px;
            width: 100%;
            max-width: 1100px;
        }

        .sidebar {
            background: #0f1629;
            border: 1px solid #1e293b;
            border-radius: 24px;
            padding: 32px 0;
            width: 280px;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 0 24px 24px;
            border-bottom: 1px solid #1e293b;
        }

        .sidebar-title {
            color: #f1f5f9;
            font-size: 20px;
            font-weight: 700;
        }

        .sidebar-nav {
            padding: 16px 0;
        }

        .nav-item {
            position: relative; /* Added for notification badge */
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            color: #94a3b8;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(59, 130, 246, 0.05);
            color: #e2e8f0;
        }

        .nav-item.active {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border-left-color: #3b82f6;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .card {
            background: #0f1629;
            border: 1px solid #1e293b;
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            flex: 1;
            padding: 48px;
            overflow-y: auto;
            max-height: calc(100vh - 40px);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .icon-wrapper {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 64px;
            height: 64px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 16px;
            margin-bottom: 16px;
        }

        .user-icon {
            width: 32px;
            height: 32px;
            stroke: #3b82f6;
            stroke-width: 2;
            fill: none;
        }

        h1 {
            color: #f1f5f9;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: #64748b;
            font-size: 14px;
        }

        .photo-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            margin-bottom: 32px;
        }

        .photo-wrapper {
            position: relative;
        }

        .photo-preview {
            width: 96px;
            height: 96px;
            border-radius: 50%;
            background: #1e293b;
            border: 2px solid #334155;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-preview svg {
            width: 40px;
            height: 40px;
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
        }

        .upload-button {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #3b82f6;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
        }

        .upload-button:hover {
            background: #2563eb;
        }

        .upload-button svg {
            width: 16px;
            height: 16px;
            stroke: white;
            stroke-width: 2;
            fill: none;
        }

        #photoInput {
            display: none;
        }

        .photo-hint {
            font-size: 12px;
            color: #64748b;
        }

        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            color: #f1f5f9;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .input-wrapper {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
            pointer-events: none;
        }

        input {
            width: 100%;
            height: 44px;
            padding-left: 40px;
            padding-right: 16px;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid #334155;
            border-radius: 12px;
            color: #f1f5f9;
            font-size: 14px;
            transition: all 0.2s;
        }

        input::placeholder {
            color: #475569;
        }

        input:focus {
            outline: none;
            border-color: #3b82f6;
            background: rgba(30, 41, 59, 0.8);
        }

        .submit-button {
            width: 100%;
            height: 44px;
            background: #3b82f6;
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: 8px;
        }

        .submit-button:hover {
            background: #2563eb;
        }

        .footer {
            margin-top: 24px;
            text-align: center;
        }

        .footer-text {
            font-size: 12px;
            color: #64748b;
            line-height: 1.5;
        }

        .empty-content {
            text-align: center;
            padding: 60px 20px;
        }

        .empty-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            stroke: #475569;
            stroke-width: 2;
            fill: none;
        }

        .empty-title {
            color: #f1f5f9;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .empty-description {
            color: #64748b;
            font-size: 14px;
            line-height: 1.6;
        }

        /* Adding charity styles */
        .charity-buttons {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
            justify-content: center;
        }

        .charity-button {
            flex: 1;
            max-width: 240px;
            height: 120px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%);
            border: 2px solid #334155;
            border-radius: 16px;
            color: #f1f5f9;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .charity-button:hover {
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(37, 99, 235, 0.1) 100%);
            transform: translateY(-2px);
        }

        .charity-button svg {
            width: 32px;
            height: 32px;
            stroke: #3b82f6;
            stroke-width: 2;
            fill: none;
        }

        .intro-form {
            background: rgba(30, 41, 59, 0.3);
            border: 1px solid #334155;
            border-radius: 16px;
            padding: 32px;
            max-width: 500px;
            margin: 0 auto;
        }

        .intro-form h2 {
            color: #f1f5f9;
            font-size: 20px;
            margin-bottom: 8px;
        }

        .intro-form p {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 24px;
        }

        .posts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .post-card {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid #334155;
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }

        .post-card:hover {
            border-color: #3b82f6;
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }

        .post-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }

        .post-content {
            padding: 16px;
        }

        /* Adding post author info with avatar */
        .post-author {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #334155;
        }

        .post-author-info {
            flex: 1;
        }

        .post-author-name {
            color: #f1f5f9;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .post-title {
            color: #f1f5f9;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .post-amount {
            color: #3b82f6;
            font-size: 18px;
            font-weight: 700;
        }

        .post-detail {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 14, 39, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }

        .post-detail.active {
            display: flex;
        }

        .post-detail-content {
            background: #0f1629;
            border: 1px solid #1e293b;
            border-radius: 24px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .post-detail-header {
            position: relative;
            height: 400px;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }

        .post-detail-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .close-button {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            background: rgba(15, 22, 41, 0.9);
            border: 1px solid #334155;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .close-button:hover {
            background: rgba(15, 22, 41, 1);
            border-color: #3b82f6;
        }

        .close-button svg {
            width: 20px;
            height: 20px;
            stroke: #f1f5f9;
            stroke-width: 2;
            fill: none;
        }

        .post-detail-body {
            padding: 32px;
        }

        /* Adding detail author section with larger avatar */
        .detail-author {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            padding-bottom: 24px;
            border-bottom: 1px solid #1e293b;
        }

        .detail-avatar {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #334155;
        }

        .detail-author-info h3 {
            color: #f1f5f9;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .detail-author-info p {
            color: #64748b;
            font-size: 13px;
        }

        .post-detail-title {
            color: #f1f5f9;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
            line-height: 1.3;
        }

        .post-detail-description {
            color: #94a3b8;
            font-size: 14px;
            line-height: 1.7;
            margin-bottom: 24px;
            white-space: pre-wrap;
        }

        .post-detail-info {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .info-row:last-child {
            margin-bottom: 0;
        }

        .info-label {
            color: #64748b;
            font-size: 14px;
        }

        .info-value {
            color: #f1f5f9;
            font-size: 14px;
            font-weight: 600;
        }

        .amount-display {
            color: #3b82f6;
            font-size: 28px;
            font-weight: 700;
        }

        .donation-section {
            background: rgba(30, 41, 59, 0.3);
            border: 1px solid #334155;
            border-radius: 16px;
            padding: 24px;
            margin-top: 24px;
        }

        .donation-title {
            color: #f1f5f9;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .slider-container {
            margin-bottom: 20px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .slider-label span {
            color: #64748b;
            font-size: 13px;
        }

        .slider-value {
            color: #3b82f6;
            font-size: 20px;
            font-weight: 700;
        }

        .slider {
            width: 100%;
            height: 8px;
            background: #1e293b;
            border-radius: 8px;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }

        .slider::-webkit-slider-thumb:hover {
            background: #2563eb;
            transform: scale(1.1);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .slider::-moz-range-thumb:hover {
            background: #2563eb;
            transform: scale(1.1);
        }

        .donate-button {
            width: 100%;
            height: 48px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .donate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #64748b;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 24px;
            transition: color 0.2s;
        }

        .back-button:hover {
            color: #3b82f6;
        }

        .back-button svg {
            width: 16px;
            height: 16px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* Adding receipt upload and chat styles */
        .receipt-upload {
            display: none;
            background: rgba(30, 41, 59, 0.3);
            border: 1px solid #334155;
            border-radius: 16px;
            padding: 24px;
            margin-top: 24px;
        }

        .receipt-upload.active {
            display: block;
        }

        .upload-area {
            border: 2px dashed #334155;
            border-radius: 12px;
            padding: 32px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 16px;
        }

        .upload-area:hover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }

        .upload-area svg {
            width: 48px;
            height: 48px;
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
            margin: 0 auto 16px;
        }

        .upload-text {
            color: #f1f5f9;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .upload-hint {
            color: #64748b;
            font-size: 13px;
        }

        .receipt-preview {
            max-width: 100%;
            border-radius: 12px;
            margin-bottom: 16px;
            display: none;
        }

        .receipt-preview.active {
            display: block;
        }

        /* Adding styles for chats tab */
        .chats-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .chat-item {
            position: relative; /* Added for notification badge */
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: rgba(30, 41, 59, 0.3); /* Changed background */
            border: 1px solid #334155;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 12px; /* Added margin */
        }

        .chat-item:hover {
            background: rgba(30, 41, 59, 0.5); /* Changed background on hover */
            border-color: #3b82f6;
        }

        .chat-item-avatar {
            width: 50px; /* Increased avatar size */
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #334155;
        }

        .chat-item-info {
            flex: 1;
        }

        .chat-item-name {
            color: #f1f5f9;
            font-size: 15px; /* Increased font size */
            font-weight: 600;
            margin-bottom: 4px;
        }

        .chat-item-last-message {
            color: #64748b;
            font-size: 13px;
        }

        .chat-item-notification { /* Added notification badge */
            position: absolute;
            top: 16px;
            right: 16px;
            width: 12px;
            height: 12px;
            background: #10b981;
            border-radius: 50%;
            border: 2px solid #0f1629;
        }

        .chat-date-separator { /* Added date separator */
            text-align: center;
            margin: 16px 0;
            position: relative;
        }

        .chat-date-separator::before,
        .chat-date-separator::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 35%;
            height: 1px;
            background: #334155;
        }

        .chat-date-separator::before {
            left: 0;
        }

        .chat-date-separator::after {
            right: 0;
        }

        .chat-date-text {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(30, 41, 59, 0.6); /* Changed background */
            border: 1px solid #334155;
            border-radius: 12px;
            color: #64748b;
            font-size: 12px;
        }

        .message-actions {
            display: none;
            gap: 8px; /* Changed gap */
            margin-top: 4px;
        }

        .chat-message:hover .message-actions {
            display: flex;
        }

        .message-edit-btn { /* Added edit button styles */
            background: transparent;
            border: none;
            color: #64748b;
            font-size: 11px;
            cursor: pointer;
            padding: 2px 8px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .message-edit-btn:hover {
            color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }


        .chat-container {
            display: none;
            flex-direction: column;
            height: 100%; /* Changed from fixed height */
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 380px;
            /* height: 500px; Removed fixed height */
            background: #0f1629;
            border: 1px solid #1e293b;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            z-index: 2000;
        }

        .chat-container.active {
            display: flex;
        }

        .chat-container-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            z-index: 3000;
        }

        .chat-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border-bottom: 1px solid #1e293b;
        }

        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #334155;
        }

        .chat-header-info {
            flex: 1;
        }

        .chat-header-name {
            color: #f1f5f9;
            font-size: 14px;
            font-weight: 600;
        }

        .chat-header-status {
            color: #64748b;
            font-size: 12px;
        }

        .chat-close {
            width: 32px;
            height: 32px;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .chat-close:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .chat-close svg {
            width: 20px;
            height: 20px;
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .chat-message {
            display: flex;
            gap: 8px;
            max-width: 80%;
        }

        .chat-message.own {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
        }

        .message-bubble {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 10px 14px;
        }

        .chat-message.own .message-bubble {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
        }

        .message-text {
            color: #f1f5f9;
            font-size: 14px;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .message-time {
            color: #64748b;
            font-size: 11px;
            margin-top: 4px;
        }

        .message-attachment {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 8px;
        }

        .chat-input-area {
            padding: 16px;
            border-top: 1px solid #1e293b;
        }

        .emoji-picker {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .emoji-btn {
            width: 32px;
            height: 32px;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid #334155;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .emoji-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
            transform: scale(1.1);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 8px;
        }

        .chat-input {
            flex: 1;
            height: 40px;
            padding: 0 12px;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid #334155;
            border-radius: 12px;
            color: #f1f5f9;
            font-size: 14px;
        }

        .chat-input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .chat-attach-btn {
            width: 40px;
            height: 40px;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid #334155;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .chat-attach-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
        }

        .chat-attach-btn svg {
            width: 20px;
            height: 20px;
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
        }

        .chat-send-btn {
            width: 40px;
            height: 40px;
            background: #3b82f6;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .chat-send-btn:hover {
            background: #2563eb;
        }

        .chat-send-btn svg {
            width: 20px;
            height: 20px;
            stroke: white;
            stroke-width: 2;
            fill: none;
        }

        .chat-button {
            width: 100%;
            height: 44px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 16px;
            display: none;
        }

        .chat-button.active {
            display: block;
        }

        .chat-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }

        /* ADDING STYLES FOR NOTIFICATION BADGE */
        .notification-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 10px;
            height: 10px;
            background: #10b981;
            border-radius: 50%;
            border: 2px solid #0f1629;
        }

        /* UPDATING CHAT CONTAINER TO NOT BE MODAL WINDOW */
        .chat-container {
            display: none;
            flex-direction: column;
            height: 100%;
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 380px;
            background: #0f1629;
            border: 1px solid #1e293b;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            z-index: 2000;
        }

        .chat-container.active {
            display: flex;
        }

        .chat-container-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            z-index: 3000;
        }

        /* ADDING BACK BUTTON FOR CHAT */
        .chat-back-btn {
            width: 32px;
            height: 32px;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background 0.2s;
            margin-right: 8px;
        }

        .chat-back-btn:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .chat-back-btn svg {
            width: 20px;
            height: 20px;
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
        }

        /* ADDING STYLES FOR CHAT LIST VIEW AND CHAT VIEW TOGGLE */
        .chats-list-view {
            display: block;
        }

        .chats-list-view.hidden {
            display: none;
        }

        .chat-view {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .chat-view.active {
            display: flex;
        }


        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
            }

            .sidebar-nav {
                display: flex;
                overflow-x: auto;
                padding: 8px 0;
            }

            .nav-item {
                flex-shrink: 0;
                border-left: none;
                border-bottom: 3px solid transparent;
            }

            .nav-item.active {
                border-left: none;
                border-bottom-color: #3b82f6;
            }

            .charity-buttons {
                flex-direction: column;
            }

            .charity-button {
                max-width: 100%;
            }

            .posts-grid {
                grid-template-columns: 1fr;
            }

            .post-detail-header {
                height: 300px;
            }

            /* Making chat fullscreen on mobile */
            .chat-container {
                width: 100%;
                height: 100%;
                bottom: 0;
                right: 0;
                border-radius: 0;
            }
        }

        @media (max-width: 480px) {
            .card {
                padding: 32px 24px;
            }

            h1 {
                font-size: 24px;
            }

            .post-detail-body {
                padding: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">–ú–µ–Ω—é</h2>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-item active" data-tab="profile">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                </div>
                <div class="nav-item" data-tab="charity">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    <span>–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span>
                </div>
                <div class="nav-item" data-tab="rating">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                    </svg>
                    <span>–†–µ–π—Ç–∏–Ω–≥</span>
                </div>
                <div class="nav-item" data-tab="info">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <span>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</span>
                </div>
                <div class="nav-item" data-tab="rules">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    <span>–ü—Ä–∞–≤–∏–ª–∞</span>
                </div>
                <!-- ADDING CHATS TAB IN NAVIGATION -->
                <div class="nav-item" data-tab="chats">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span>–ß–∞—Ç—ã</span>
                    <span class="notification-badge" id="chatsNotificationBadge" style="display: none;"></span>
                </div>
            </nav>
        </div>

        <div class="card">
            <div class="content-section active" id="profile">
                <div class="header">
                    <div class="icon-wrapper">
                        <svg class="user-icon" viewBox="0 0 24 24">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <h1>–ü—Ä–æ—Ñ–∏–ª—å</h1>
                    <p class="subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ</p>
                </div>

                <form id="profileForm">
                    <div class="photo-section">
                        <div class="photo-wrapper">
                            <div class="photo-preview" id="photoPreview">
                                <svg viewBox="0 0 24 24">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                            </div>
                            <label for="photoInput" class="upload-button">
                                <svg viewBox="0 0 24 24">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="17 8 12 3 7 8"></polyline>
                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                </svg>
                            </label>
                            <input type="file" id="photoInput" accept="image/*">
                        </div>
                        <p class="photo-hint">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</p>
                    </div>

                    <div class="form-group">
                        <label for="firstName">–ò–º—è</label>
                        <div class="input-wrapper">
                            <svg class="input-icon" viewBox="0 0 24 24">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            <input type="text" id="firstName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="lastName">–§–∞–º–∏–ª–∏—è</label>
                        <div class="input-wrapper">
                            <svg class="input-icon" viewBox="0 0 24 24">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            <input type="text" id="lastName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —Ñ–∞–º–∏–ª–∏—é">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="phone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
                        <div class="input-wrapper">
                            <svg class="input-icon" viewBox="0 0 24 24">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                            </svg>
                            <input type="tel" id="phone" placeholder="+7 (___) ___-__-__">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="password">–ü–∞—Ä–æ–ª—å</label>
                        <div class="input-wrapper">
                            <svg class="input-icon" viewBox="0 0 24 24">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                            </svg>
                            <input type="password" id="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                        </div>
                    </div>

                    <button type="submit" class="submit-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </form>

                <div class="footer">
                    <p class="footer-text">
                        –ù–∞–∂–∏–º–∞—è "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
                    </p>
                </div>
            </div>

            <!-- New charity section with buttons, intro form, and posts -->
            <div class="content-section" id="charity">
                <div class="header">
                    <div class="icon-wrapper">
                        <svg class="user-icon" viewBox="0 0 24 24">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <h1>–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h1>
                    <p class="subtitle">–ü–æ–º–æ–≥–∏—Ç–µ —Ç–µ–º, –∫—Ç–æ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ</p>
                </div>

                <div id="charityInitial">
                    <div class="charity-buttons">
                        <button class="charity-button" id="wantToHelpBtn">
                            <svg viewBox="0 0 24 24">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                            </svg>
                            –Ø —Ö–æ—á—É –ø–æ–º–æ—á—å
                        </button>
                        <button class="charity-button" id="needHelpBtn">
                            <svg viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                            </svg>
                            –ú–Ω–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å
                        </button>
                    </div>
                </div>

                <div id="introForm" style="display: none;">
                    <div class="intro-form">
                        <h2>–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ—Å—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞</h2>
                        <p>–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ—Å—å</p>
                        <form id="helperForm">
                            <div class="form-group">
                                <label for="helperName">–í–∞—à–µ –∏–º—è</label>
                                <div class="input-wrapper">
                                    <svg class="input-icon" viewBox="0 0 24 24">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="12" cy="7" r="4"></circle>
                                    </svg>
                                    <input type="text" id="helperName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" required>
                                </div>
                            </div>
                            <button type="submit" class="submit-button">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                        </form>
                    </div>
                </div>

                <div id="postsList" style="display: none;">
                    <div class="back-button" id="backToButtons">
                        <svg viewBox="0 0 24 24">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        –ù–∞–∑–∞–¥
                    </div>
                    <div class="posts-grid" id="postsContainer"></div>
                    
                    <div class="donation-section">
                        <h3 class="donation-title">–í–∞—à–µ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ</h3>
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>–°—É–º–º–∞ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è</span>
                                <span class="slider-value" id="donationValue">0 ‚ÇΩ</span>
                            </div>
                            <input type="range" min="0" max="50000" value="0" class="slider" id="donationSlider">
                        </div>
                        <button class="donate-button" id="donateBtn">–ü–æ–º–æ—á—å</button>
                    </div>
                </div>
            </div>

            <div class="content-section" id="rating">
                <div class="empty-content">
                    <svg class="empty-icon" viewBox="0 0 24 24">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                    </svg>
                    <h1 class="empty-title">–†–µ–π—Ç–∏–Ω–≥</h1>
                    <p class="empty-description">–ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∞—à —Ä–µ–π—Ç–∏–Ω–≥ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</p>
                </div>
            </div>

            <div class="content-section" id="info">
                <div class="empty-content">
                    <svg class="empty-icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <h1 class="empty-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h1>
                    <p class="empty-description">–ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è—Ö</p>
                </div>
            </div>

            <div class="content-section" id="rules">
                <div class="empty-content">
                    <svg class="empty-icon" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    <h1 class="empty-title">–ü—Ä–∞–≤–∏–ª–∞</h1>
                    <p class="empty-description">–ó–¥–µ—Å—å –±—É–¥—É—Ç –ø—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</p>
                </div>
            </div>

            <!-- ADDING CHATS SECTION -->
            <div class="content-section" id="chats">
                <div class="chats-list-view" id="chatsListView">
                    <div class="header">
                        <div class="icon-wrapper">
                            <svg class="user-icon" viewBox="0 0 24 24">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            </svg>
                        </div>
                        <h1>–ß–∞—Ç—ã</h1>
                        <p class="subtitle">–í–∞—à–∏ –¥–∏–∞–ª–æ–≥–∏ —Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º–∏ –ø–æ–º–æ—â–∏</p>
                    </div>

                    <div class="chats-list" id="chatsList">
                        <!-- Chats will be dynamically added here -->
                    </div>

                    <div id="emptyChats" class="empty-content">
                        <svg class="empty-icon" viewBox="0 0 24 24">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                        <h2 class="empty-title">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤</h2>
                        <p class="empty-description">–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–∞—à–µ–≥–æ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è<br>–∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –¥–∏–∞–ª–æ–≥–∏ —Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º–∏ –ø–æ–º–æ—â–∏</p>
                    </div>
                </div>

                <div class="chat-view" id="chatView">
                    <div class="chat-header">
                        <button class="chat-back-btn" id="chatBackBtn">
                            <svg viewBox="0 0 24 24">
                                <line x1="19" y1="12" x2="5" y2="12"></line>
                                <polyline points="12 19 5 12 12 5"></polyline>
                            </svg>
                        </button>
                        <img src="/placeholder.svg" alt="" class="chat-avatar" id="chatRecipientAvatar">
                        <div class="chat-header-info">
                            <div class="chat-header-name" id="chatRecipientName">–ê–Ω–Ω–∞ –°.</div>
                            <div class="chat-header-status">–æ–Ω–ª–∞–π–Ω</div>
                        </div>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <!-- Messages will be dynamically added here -->
                    </div>
                    <div class="chat-input-area">
                        <div class="emoji-picker">
                            <button class="emoji-btn" data-emoji="üòä">üòä</button>
                            <button class="emoji-btn" data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</button>
                            <button class="emoji-btn" data-emoji="üôè">üôè</button>
                            <button class="emoji-btn" data-emoji="üëç">üëç</button>
                            <button class="emoji-btn" data-emoji="üéâ">üéâ</button>
                            <button class="emoji-btn" data-emoji="üí™">üí™</button>
                            <button class="emoji-btn" data-emoji="üåü">üåü</button>
                            <button class="emoji-btn" data-emoji="‚ú®">‚ú®</button>
                        </div>
                        <div class="chat-input-wrapper">
                            <input type="text" class="chat-input" id="chatInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                            <label for="chatAttachment" class="chat-attach-btn">
                                <svg viewBox="0 0 24 24">
                                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                                </svg>
                            </label>
                            <input type="file" id="chatAttachment" accept="image/*,video/*" style="display: none;">
                            <button class="chat-send-btn" id="sendMessage">
                                <svg viewBox="0 0 24 24">
                                    <line x1="22" y1="2" x2="11" y2="13"></line>
                                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Post detail modal -->
    <div class="post-detail" id="postDetail">
        <div class="post-detail-content">
            <div class="post-detail-header">
                <img src="/placeholder.svg" alt="" class="post-detail-image" id="detailImage">
                <button class="close-button" id="closeDetail">
                    <svg viewBox="0 0 24 24">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="post-detail-body">
                <!-- Adding author section with avatar -->
                <div class="detail-author">
                    <img src="/placeholder.svg" alt="" class="detail-avatar" id="detailAuthorAvatar">
                    <div class="detail-author-info">
                        <h3 id="detailAuthorName"></h3>
                        <p>–ù—É–∂–¥–∞–µ—Ç—Å—è –≤ –ø–æ–º–æ—â–∏</p>
                    </div>
                </div>

                <h2 class="post-detail-title" id="detailTitle"></h2>
                <p class="post-detail-description" id="detailDescription"></p>
                
                <div class="post-detail-info">
                    <div class="info-row">
                        <span class="info-label">–ù–µ–æ–±—Ö–æ–¥–∏–º–∞—è —Å—É–º–º–∞:</span>
                        <span class="amount-display" id="detailAmount"></span>
                    </div>
                    <!-- Adding recipient and bank info -->
                    <div class="info-row">
                        <span class="info-label">–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</span>
                        <span class="info-value" id="detailRecipient"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ë–∞–Ω–∫:</span>
                        <span class="info-value" id="detailBank"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</span>
                        <span class="info-value" id="detailPhone"></span>
                    </div>
                </div>

                <div class="donation-section">
                    <h3 class="donation-title">–í–∞—à–µ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ</h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>–°—É–º–º–∞ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è</span>
                            <span class="slider-value" id="detailDonationValue">0 ‚ÇΩ</span>
                        </div>
                        <input type="range" min="0" max="50000" value="0" class="slider" id="detailDonationSlider">
                    </div>
                    <button class="donate-button" id="detailDonateBtn">–ü–æ–º–æ—á—å</button>
                </div>

                <!-- Adding receipt upload section -->
                <div class="receipt-upload" id="receiptUpload">
                    <h3 class="donation-title">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —á–µ–∫ –æ –ø–µ—Ä–µ–≤–æ–¥–µ</h3>
                    <div class="upload-area" id="uploadArea">
                        <svg viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        <p class="upload-text">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ–∫–∞</p>
                        <p class="upload-hint">PNG, JPG, PDF –¥–æ 10MB</p>
                    </div>
                    <img src="/placeholder.svg" alt="Receipt preview" class="receipt-preview" id="receiptPreview">
                    <input type="file" id="receiptInput" accept="image/*,.pdf" style="display: none;">
                    <button class="submit-button" id="submitReceipt" style="display: none;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É</button>
                </div>

                <!-- Adding chat button -->
                <button class="chat-button" id="openChatBtn">
                    üí¨ –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç —Å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º
                </button>
            </div>
        </div>
    </div>

    <!-- CHAT CONTAINER (NOW FULLSCREEN ON MOBILE, AND MODAL ON DESKTOP) -->
    <div class="chat-container" id="chatContainer">
        <div class="chat-header">
            <button class="chat-close" id="closeChat">
                <svg viewBox="0 0 24 24">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <img src="/placeholder.svg" alt="" class="chat-avatar" id="chatRecipientAvatar">
            <div class="chat-header-info">
                <div class="chat-header-name" id="chatRecipientName">–ê–Ω–Ω–∞ –°.</div>
                <div class="chat-header-status">–æ–Ω–ª–∞–π–Ω</div>
            </div>
        </div>
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be dynamically added here -->
        </div>
        <div class="chat-input-area">
            <div class="emoji-picker">
                <button class="emoji-btn" data-emoji="üòä">üòä</button>
                <button class="emoji-btn" data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</button>
                <button class="emoji-btn" data-emoji="üôè">üôè</button>
                <button class="emoji-btn" data-emoji="üëç">üëç</button>
                <button class="emoji-btn" data-emoji="üéâ">üéâ</button>
                <button class="emoji-btn" data-emoji="üí™">üí™</button>
                <button class="emoji-btn" data-emoji="üåü">üåü</button>
                <button class="emoji-btn" data-emoji="‚ú®">‚ú®</button>
            </div>
            <div class="chat-input-wrapper">
                <input type="text" class="chat-input" id="chatInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                <label for="chatAttachment" class="chat-attach-btn">
                    <svg viewBox="0 0 24 24">
                        <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                    </svg>
                </label>
                <input type="file" id="chatAttachment" accept="image/*,video/*" style="display: none;">
                <button class="chat-send-btn" id="sendMessage">
                    <svg viewBox="0 0 24 24">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const charityPosts = [
                {
                    id: 1,
                    title: "–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ–º–æ–π",
                    authorName: "–ê–Ω–Ω–∞ –°–æ–∫–æ–ª–æ–≤–∞",
                    authorFull: "–ê–Ω–Ω–∞ –°–æ–∫–æ–ª–æ–≤–∞",
                    authorShort: "–ê–Ω–Ω–∞ –°.",
                    avatar: "avatars/avatar-1.jpg",
                    description: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–Ω–Ω–∞, –º–Ω–µ 24 –≥–æ–¥–∞. –Ø –∑–∞—Å—Ç—Ä—è–ª–∞ –≤ —á—É–∂–æ–º –≥–æ—Ä–æ–¥–µ –±–µ–∑ –¥–µ–Ω–µ–≥ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—É–∫—Ä–∞–ª–∏ —Å—É–º–∫—É). –ú–Ω–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å, —á—Ç–æ–±—ã –∫—É–ø–∏—Ç—å –±–∏–ª–µ—Ç –¥–æ–º–æ–π –≤ –ú–æ—Å–∫–≤—É. –£ –º–µ–Ω—è –¥–æ–º–∞ –∂–¥–µ—Ç –±–æ–ª—å–Ω–∞—è –º–∞–º–∞, –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–µ–Ω —É—Ö–æ–¥. –Ø –æ–±–µ—â–∞—é –≤–µ—Ä–Ω—É—Ç—å –¥–µ–Ω—å–≥–∏, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –¥–æ–±–µ—Ä—É—Å—å –¥–æ –¥–æ–º–∞. –ë—É–¥—É –æ—á–µ–Ω—å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–∞ –∑–∞ –ª—é–±—É—é –ø–æ–º–æ—â—å. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –¥–ª—è –º–µ–Ω—è.",
                    amount: 5000,
                    recipient: "–ê–Ω–Ω–∞ –°.",
                    bank: "–°–±–µ—Ä–±–∞–Ω–∫",
                    phone: "+7 (912) 345-67-89",
                    image: "image/1.jfif"
                },
                {
                    id: 2,
                    title: "–õ–µ—á–µ–Ω–∏–µ –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞",
                    authorName: "–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
                    authorFull: "–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
                    authorShort: "–ú–∞—Ä–∏—è –ü.",
                    avatar: "avatars/avatar-2.jpg",
                    description: "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ú–∞—Ä–∏—è. –£ –º–æ–µ–π –¥–æ—á–∫–∏ –°–∞—à–∏ (7 –ª–µ—Ç) —Å–µ—Ä—å–µ–∑–Ω–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–µ–µ –ª–µ—á–µ–Ω–∏–µ –∏ —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è. –ú—ã –æ–¥–Ω–∞ —Å–µ–º—å—è, –º—É–∂ –ø–æ—Ç–µ—Ä—è–ª —Ä–∞–±–æ—Ç—É –∏–∑-–∑–∞ –∫—Ä–∏–∑–∏—Å–∞. –ù–∞–º –æ—á–µ–Ω—å –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å –¥–ª—è –æ–ø–ª–∞—Ç—ã –∫—É—Ä—Å–∞ –ª–µ—á–µ–Ω–∏—è. –ö–∞–∂–¥—ã–π —Ä—É–±–ª—å –Ω–∞ —Å—á–µ—Ç—É. –í—Ä–∞—á–∏ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ –µ—Å—Ç—å —à–∞–Ω—Å –Ω–∞ –≤—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ, –Ω–æ –Ω—É–∂–Ω–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä–æ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–º–æ–≥–∏—Ç–µ –Ω–∞—à–µ–π –¥–µ–≤–æ—á–∫–µ –≤—Å—Ç–∞—Ç—å –Ω–∞ –Ω–æ–≥–∏!",
                    amount: 125000,
                    recipient: "–ú–∞—Ä–∏—è –ü.",
                    bank: "–í–¢–ë",
                    phone: "+7 (923) 456-78-90",
                    image: "image/2.jpg"
                },
                {
                    id: 3,
                    title: "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ–∂–∞—Ä–∞",
                    authorName: "–ü–µ—Ç—Ä –ò–≤–∞–Ω–æ–≤",
                    authorFull: "–ü–µ—Ç—Ä –ò–≤–∞–Ω–æ–≤",
                    authorShort: "–ü–µ—Ç—Ä –ò.",
                    avatar: "avatars/avatar-3.jpg",
                    description: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –ú–µ–Ω—è –∑–æ–≤—É—Ç –ü–µ—Ç—Ä, –º–Ω–µ 45 –ª–µ—Ç. –ú–µ—Å—è—Ü –Ω–∞–∑–∞–¥ –≤ –Ω–∞—à–µ–º –¥–æ–º–µ —Å–ª—É—á–∏–ª—Å—è –ø–æ–∂–∞—Ä. –ú—ã —Å –∂–µ–Ω–æ–π –∏ –¥–≤—É–º—è –¥–µ—Ç—å–º–∏ –ø–æ—Ç–µ—Ä—è–ª–∏ –≤—Å–µ - –¥–æ–º, –≤–µ—â–∏, –¥–æ–∫—É–º–µ–Ω—Ç—ã. –°–µ–π—á–∞—Å –∂–∏–≤–µ–º —É —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –≤ —Ç–µ—Å–Ω–æ—Ç–µ. –û—á–µ–Ω—å –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–æ—Ç—è –±—ã –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –¥–ª—è –∂–∏–∑–Ω–∏ - –∫—É–ø–∏—Ç—å –∫—Ä–æ–≤–∞—Ç–∏, –æ–¥–µ–∂–¥—É, –ø–æ—Å—É–¥—É. –†–∞–±–æ—Ç–∞—é, –Ω–æ –∑–∞—Ä–ø–ª–∞—Ç—ã –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –≤—Å–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å. –ë—É–¥—É –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –ª—é–±—É—é –ø–æ–º–æ—â—å.",
                    amount: 75000,
                    recipient: "–ü–µ—Ç—Ä –ò.",
                    bank: "–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫",
                    phone: "+7 (934) 567-89-01",
                    image: "image/3.jfif"
                },
                {
                    id: 4,
                    title: "–ü–æ–º–æ—â—å –ø–æ–∂–∏–ª–æ–π –∂–µ–Ω—â–∏–Ω–µ",
                    authorName: "–í–µ—Ä–∞ –ò–≤–∞–Ω–æ–≤–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞",
                    authorFull: "–í–µ—Ä–∞ –ò–≤–∞–Ω–æ–≤–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞",
                    authorShort: "–í–µ—Ä–∞ –ò.",
                    avatar: "avatars/avatar-4.jpg",
                    description: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –º–µ–Ω—è –∑–æ–≤—É—Ç –ï–ª–µ–Ω–∞. –Ø –ø–æ–º–æ–≥–∞—é —Å–≤–æ–µ–π –ø–æ–∂–∏–ª–æ–π —Å–æ—Å–µ–¥–∫–µ –í–µ—Ä–µ –ò–≤–∞–Ω–æ–≤–Ω–µ (82 –≥–æ–¥–∞). –û–Ω–∞ –∂–∏–≤–µ—Ç –æ–¥–Ω–∞, –ø–µ–Ω—Å–∏—è –º–∞–ª–µ–Ω—å–∫–∞—è, –∞ –µ–π –Ω—É–∂–Ω—ã –¥–æ—Ä–æ–≥–∏–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –æ—Ç —Å–µ—Ä–¥—Ü–∞ –∏ –¥–∏–∞–±–µ—Ç–∞. –ù–∞ –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–µ –æ–Ω–∞ —Å–ª–æ–º–∞–ª–∞ –±–µ–¥—Ä–æ, –Ω—É–∂–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è. –£ –º–µ–Ω—è —Å–∞–º–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã. –ü—Ä–æ—à—É –ø–æ–º–æ—á—å —ç—Ç–æ–π –¥–æ–±—Ä–æ–π –±–∞–±—É—à–∫–µ, –∫–æ—Ç–æ—Ä–∞—è –≤—Å—é –∂–∏–∑–Ω—å –ø–æ–º–æ–≥–∞–ª–∞ –¥—Ä—É–≥–∏–º. –û–Ω–∞ –æ—á–µ–Ω—å —Å–∫—Ä–æ–º–Ω–∞—è –∏ –Ω–µ –ø—Ä–æ—Å–∏—Ç —Å–∞–º–∞, –Ω–æ –ø–æ–º–æ—â—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–∞.",
                    amount: 95000,
                    recipient: "–í–µ—Ä–∞ –ò.",
                    bank: "–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫",
                    phone: "+7 (945) 678-90-12",
                    image: "image/4.avif"
                },
                {
                    id: 5,
                    title: "–†–µ–º–æ–Ω—Ç –∏–Ω–≤–∞–ª–∏–¥–Ω–æ–π –∫–æ–ª—è—Å–∫–∏",
                    authorName: "–î–º–∏—Ç—Ä–∏–π –ö–æ–∑–ª–æ–≤",
                    authorFull: "–î–º–∏—Ç—Ä–∏–π –ö–æ–∑–ª–æ–≤",
                    authorShort: "–î–º–∏—Ç—Ä–∏–π –ö.",
                    avatar: "avatars/avatar-5.jpg",
                    description: "–ü—Ä–∏–≤–µ—Ç! –Ø –î–º–∏—Ç—Ä–∏–π, 32 –≥–æ–¥–∞, –∏–Ω–≤–∞–ª–∏–¥-–∫–æ–ª—è—Å–æ—á–Ω–∏–∫. –ú–æ—è –∫–æ–ª—è—Å–∫–∞ —Å–ª–æ–º–∞–ª–∞—Å—å, –∞ –Ω–æ–≤–∞—è —Å—Ç–æ–∏—Ç –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ. –ë–µ–∑ –∫–æ–ª—è—Å–∫–∏ —è –Ω–µ –º–æ–≥—É –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è, –Ω–µ –º–æ–≥—É —Ä–∞–±–æ—Ç–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω–æ –∏ –≤–µ—Å—Ç–∏ –æ–±—ã—á–Ω—É—é –∂–∏–∑–Ω—å. –ü—ã—Ç–∞–ª—Å—è —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å, –Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç. –û—á–µ–Ω—å –ø—Ä–æ—à—É –ø–æ–º–æ—á—å —Å–æ–±—Ä–∞—Ç—å –Ω–∞ —Ä–µ–º–æ–Ω—Ç. –≠—Ç–æ –¥–ª—è –º–µ–Ω—è –∂–∏–∑–Ω–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ - –∫–æ–ª—è—Å–∫–∞ —ç—Ç–æ –º–æ—è —Å–≤–æ–±–æ–¥–∞ –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å. –°–ø–∞—Å–∏–±–æ –≤—Å–µ–º, –∫—Ç–æ –æ—Ç–∫–ª–∏–∫–Ω–µ—Ç—Å—è!",
                    amount: 45000,
                    recipient: "–î–º–∏—Ç—Ä–∏–π –ö.",
                    bank: "–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω–±–∞–Ω–∫",
                    phone: "+7 (956) 789-01-23",
                    image: "image/5.webp"
                },
                {
                    id: 6,
                    title: "–ö–æ—Ä–º –¥–ª—è –ø—Ä–∏—é—Ç–∞ –∂–∏–≤–æ—Ç–Ω—ã—Ö",
                    authorName: "–ê–ª–µ—Å—è –í–æ–ª–∫–æ–≤–∞",
                    authorFull: "–ê–ª–µ—Å—è –í–æ–ª–∫–æ–≤–∞",
                    authorShort: "–ê–ª–µ—Å—è –í.",
                    avatar: "avatars/avatar-6.jpg",
                    description: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –≤–æ–ª–æ–Ω—Ç–µ—Ä –ø—Ä–∏—é—Ç–∞ –¥–ª—è –±–µ–∑–¥–æ–º–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö '–ù–∞–¥–µ–∂–¥–∞'. –£ –Ω–∞—Å —Å–µ–π—á–∞—Å 47 —Å–æ–±–∞–∫ –∏ 32 –∫–æ—à–∫–∏. –ù–∞—à–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ–Ω—Å–æ—Ä—ã –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞ –∫–æ—Ä–º–∞ –æ—Å—Ç–∞–ª–æ—Å—å –Ω–∞ –Ω–µ–¥–µ–ª—é. –ñ–∏–≤–æ—Ç–Ω—ã–µ –Ω–µ –≤–∏–Ω–æ–≤–∞—Ç—ã –≤ —Å–ª–æ–∂–∏–≤—à–µ–π—Å—è —Å–∏—Ç—É–∞—Ü–∏–∏. –ù–∞–º —Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å –Ω–∞ –∑–∞–∫—É–ø–∫—É –∫–æ—Ä–º–∞, –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏ –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ. –ö–∞–∂–¥–∞—è –∫–æ–ø–µ–π–∫–∞ –∏–¥–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω—É–∂–¥—ã –∂–∏–≤–æ—Ç–Ω—ã—Ö. –ü–æ–º–æ–≥–∏—Ç–µ –Ω–∞–º –Ω–µ –±—Ä–æ—Å–∏—Ç—å –Ω–∞—à–∏—Ö –ø–æ–¥–æ–ø–µ—á–Ω—ã—Ö!",
                    amount: 67000,
                    recipient: "–ê–ª–µ—Å—è –í.",
                    bank: "–°–±–µ—Ä–±–∞–Ω–∫",
                    phone: "+7 (967) 890-12-34",
                    image: "image/6.jpg"
                },
                {
                    id: 7,
                    title: "–û–ø–ª–∞—Ç–∞ –æ–±—â–µ–∂–∏—Ç–∏—è —Å—Ç—É–¥–µ–Ω—Ç—É",
                    authorName: "–ú–∞–∫—Å–∏–º –ù–æ–≤–∏–∫–æ–≤",
                    authorFull: "–ú–∞–∫—Å–∏–º –ù–æ–≤–∏–∫–æ–≤",
                    authorShort: "–ú–∞–∫—Å–∏–º –ù.",
                    avatar: "avatars/avatar-7.jpg",
                    description: "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ú–∞–∫—Å–∏–º, —è —Å—Ç—É–¥–µ–Ω—Ç 3 –∫—É—Ä—Å–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞. –£—á—É—Å—å –Ω–∞ –±—é–¥–∂–µ—Ç–µ, –Ω–æ –º–µ—Å—Ç–æ –≤ –æ–±—â–µ–∂–∏—Ç–∏–∏ –ø–ª–∞—Ç–Ω–æ–µ. –†–æ–¥–∏—Ç–µ–ª–∏ –∏–∑ –¥–µ—Ä–µ–≤–Ω–∏, –ø–æ–º–æ—á—å –Ω–µ –º–æ–≥—É—Ç. –†–∞–±–æ—Ç–∞—é –ø–æ –≤–µ—á–µ—Ä–∞–º, –Ω–æ –Ω–µ —É—Å–ø–µ–≤–∞—é –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –æ–ø–ª–∞—Ç—É. –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é –Ω—É–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –æ–ø–ª–∞—Ç—É, –∏–Ω–∞—á–µ –≤—ã—Å–µ–ª—è—Ç, –∏ —è –Ω–µ —Å–º–æ–≥—É –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —É—á–µ–±—É. –û—á–µ–Ω—å —Ö–æ—á—É –∑–∞–∫–æ–Ω—á–∏—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏ –≤—ã–±–∏—Ç—å—Å—è –≤ –ª—é–¥–∏. –ü—Ä–æ—à—É –ø–æ–º–æ—á—å –æ–ø–ª–∞—Ç–∏—Ç—å —Å–µ–º–µ—Å—Ç—Ä –≤ –æ–±—â–µ–∂–∏—Ç–∏–∏. –û–±–µ—â–∞—é —Ç–∞–∫ –∂–µ –ø–æ–º–æ–≥–∞—Ç—å –¥—Ä—É–≥–∏–º, –∫–æ–≥–¥–∞ –≤—Å—Ç–∞–Ω—É –Ω–∞ –Ω–æ–≥–∏.",
                    amount: 18000,
                    recipient: "–ú–∞–∫—Å–∏–º –ù.",
                    bank: "–í–¢–ë",
                    phone: "+7 (978) 901-23-45",
                    image: "image/7.jpeg"
                },
                {
                    id: 8,
                    title: "–ü—Ä–æ—Ç–µ–∑ –Ω–æ–≥–∏ –¥–ª—è –≤–µ—Ç–µ—Ä–∞–Ω–∞",
                    authorName: "–ù–∏–∫–æ–ª–∞–π –§–µ–¥–æ—Ä–æ–≤–∏—á –ú–æ—Ä–æ–∑–æ–≤",
                    authorFull: "–ù–∏–∫–æ–ª–∞–π –§–µ–¥–æ—Ä–æ–≤–∏—á –ú–æ—Ä–æ–∑–æ–≤",
                    authorShort: "–ù–∏–∫–æ–ª–∞–π –§.",
                    avatar: "avatars/avatar-8.jpg",
                    description: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –Ø —Å—ã–Ω –≤–µ—Ç–µ—Ä–∞–Ω–∞ –±–æ–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –ú–æ–µ–º—É –æ—Ç—Ü—É 68 –ª–µ—Ç, –æ–Ω –ø–æ—Ç–µ—Ä—è–ª –Ω–æ–≥—É –Ω–∞ —Å–ª—É–∂–±–µ. –°—Ç–∞—Ä—ã–π –ø—Ä–æ—Ç–µ–∑ –∏–∑–Ω–æ—Å–∏–ª—Å—è –∏ –ø—Ä–∏—á–∏–Ω—è–µ—Ç –±–æ–ª—å. –ù–æ–≤—ã–π –ø—Ä–æ—Ç–µ–∑ —Å—Ç–æ–∏—Ç –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ. –ü–µ–Ω—Å–∏—è —É –æ—Ç—Ü–∞ –Ω–µ–±–æ–ª—å—à–∞—è. –û–Ω –≤—Å—é –∂–∏–∑–Ω—å —Å–ª—É–∂–∏–ª –†–æ–¥–∏–Ω–µ, –∞ —Ç–µ–ø–µ—Ä—å –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ø–æ–º–æ—â–∏. –•–æ—á—É –ø–æ–º–æ—á—å –µ–º—É, –Ω–æ –º–æ–∏—Ö —Å—Ä–µ–¥—Å—Ç–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç. –ü—Ä–æ—à—É –Ω–µ—Ä–∞–≤–Ω–æ–¥—É—à–Ω—ã—Ö –ª—é–¥–µ–π –ø–æ–º–æ—á—å –≤–µ—Ç–µ—Ä–∞–Ω—É –æ–±—Ä–µ—Å—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ö–æ–¥–∏—Ç—å –±–µ–∑ –±–æ–ª–∏.",
                    amount: 185000,
                    recipient: "–ù–∏–∫–æ–ª–∞–π –§.",
                    bank: "–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫",
                    phone: "+7 (989) 012-34-56",
                    image: "image/8.jpg"
                },
                {
                    id: 9,
                    title: "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ç–∞–ª–∞–Ω—Ç–ª–∏–≤–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞",
                    authorName: "–û–ª—å–≥–∞ –í–∞—Å–∏–ª—å–µ–≤–∞",
                    authorFull: "–û–ª—å–≥–∞ –í–∞—Å–∏–ª—å–µ–≤–∞",
                    authorShort: "–û–ª—å–≥–∞ –í.",
                    avatar: "avatars/avatar-9.jpg",
                    description: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –º–µ–Ω—è –∑–æ–≤—É—Ç –û–ª—å–≥–∞. –ú–æ–π —Å—ã–Ω –õ—ë—à–∞ (10 –ª–µ—Ç) –æ—á–µ–Ω—å —Ç–∞–ª–∞–Ω—Ç–ª–∏–≤ –≤ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏. –û–Ω –≤—ã–∏–≥—Ä–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ª–∏–º–ø–∏–∞–¥. –ï–º—É –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –º–µ—Å—Ç–æ –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —à–∫–æ–ª–µ –¥–ª—è –æ–¥–∞—Ä–µ–Ω–Ω—ã—Ö –¥–µ—Ç–µ–π, –Ω–æ –æ–±—É—á–µ–Ω–∏–µ –ø–ª–∞—Ç–Ω–æ–µ. –Ø –æ–¥–Ω–∞ –≤–æ—Å–ø–∏—Ç—ã–≤–∞—é –¥–≤–æ–∏—Ö –¥–µ—Ç–µ–π, —Ä–∞–±–æ—Ç–∞—é —É—á–∏—Ç–µ–ª–µ–º. –ó–∞—Ä–ø–ª–∞—Ç–∞ –º–∞–ª–µ–Ω—å–∫–∞—è, –Ω–∞ —Ç–∞–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç. –ù–µ —Ö–æ—á—É, —á—Ç–æ–±—ã —Ç–∞–ª–∞–Ω—Ç —Å—ã–Ω–∞ –ø—Ä–æ–ø–∞–ª. –ü—Ä–æ—à—É –ø–æ–º–æ—á—å –¥–∞—Ç—å –µ–º—É —à–∞–Ω—Å –Ω–∞ –¥–æ—Å—Ç–æ–π–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –±—É–¥—É—â–µ–µ.",
                    amount: 52000,
                    recipient: "–û–ª—å–≥–∞ –í.",
                    bank: "–û—Ç–∫—Ä—ã—Ç–∏–µ",
                    phone: "+7 (990) 123-45-67",
                    image: "image/9.jpg"
                },
                {
                    id: 10,
                    title: "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏",
                    authorName: "–ò–≥–æ—Ä—å –õ–µ–±–µ–¥–µ–≤",
                    authorFull: "–ò–≥–æ—Ä—å –õ–µ–±–µ–¥–µ–≤",
                    authorShort: "–ò–≥–æ—Ä—å –õ.",
                    avatar: "avatars/avatar-10.jpg",
                    description: "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≥–æ—Ä—å, –º–Ω–µ 38 –ª–µ—Ç. –ü–æ–ª–≥–æ–¥–∞ –Ω–∞–∑–∞–¥ –ø–µ—Ä–µ–Ω–µ—Å —Å–ª–æ–∂–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –Ω–∞ –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–µ. –û–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ, –Ω–æ –Ω—É–∂–Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –º–∞—Å—Å–∞–∂, —Ñ–∏–∑–∏–æ—Ç–µ—Ä–∞–ø–∏—è. –ù–∞ –ª–µ—á–µ–Ω–∏–µ —É—à–ª–∏ –≤—Å–µ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è. –°–µ–π—á–∞—Å –Ω–µ –º–æ–≥—É —Ä–∞–±–æ—Ç–∞—Ç—å, –∂–µ–Ω–∞ –æ–¥–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–º—å—é –∏ –¥–≤–æ–∏—Ö –¥–µ—Ç–µ–π. –†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞, —á—Ç–æ–±—ã —è —Å–º–æ–≥ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –∏ —Ä–∞–±–æ—Ç–µ. –ü—Ä–æ—à—É –ø–æ–º–æ—á—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –ª–µ—á–µ–Ω–∏–µ. –•–æ—á—É —Å–Ω–æ–≤–∞ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –æ–ø–æ—Ä–æ–π –¥–ª—è —Å–≤–æ–µ–π —Å–µ–º—å–∏.",
                    amount: 89000,
                    recipient: "–ò–≥–æ—Ä—å –õ.",
                    bank: "–°–æ–≤–∫–æ–º–±–∞–Ω–∫",
                    phone: "+7 (901) 234-56-78",
                    image: "image/10.jpg"
                }
            ];

            const navItems = document.querySelectorAll('.nav-item');
            const contentSections = document.querySelectorAll('.content-section');

            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    const tabId = item.getAttribute('data-tab');
                    
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    
                    contentSections.forEach(section => section.classList.remove('active'));
                    document.getElementById(tabId).classList.add('active');

                    if (tabId === 'chats') {
                        renderChatsList();
                    }
                });
            });

            const photoInput = document.getElementById('photoInput');
            const photoPreview = document.getElementById('photoPreview');

            const savedProfile = getFromLocalStorage('userProfile');
            if (savedProfile) {
                if (savedProfile.photo) {
                    photoPreview.innerHTML = `<img src="${savedProfile.photo}" alt="Preview">`;
                }
                if (savedProfile.firstName) document.getElementById('firstName').value = savedProfile.firstName;
                if (savedProfile.lastName) document.getElementById('lastName').value = savedProfile.lastName;
                if (savedProfile.phone) document.getElementById('phone').value = savedProfile.phone;
            }

            photoInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        photoPreview.innerHTML = `<img src="${event.target.result}" alt="Preview">`;
                        const profile = getFromLocalStorage('userProfile') || {};
                        profile.photo = event.target.result;
                        saveToLocalStorage('userProfile', profile);
                    };
                    reader.readAsDataURL(file);
                }
            });

            const profileForm = document.getElementById('profileForm');
            profileForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    firstName: document.getElementById('firstName').value,
                    lastName: document.getElementById('lastName').value,
                    phone: document.getElementById('phone').value,
                    password: document.getElementById('password').value,
                    photo: getFromLocalStorage('userProfile')?.photo || null
                };

                saveToLocalStorage('userProfile', formData);
                alert('–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
            });

            const phoneInput = document.getElementById('phone');
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 0) {
                    if (value[0] !== '7') {
                        value = '7' + value;
                    }
                    let formatted = '+7';
                    if (value.length > 1) {
                        formatted += ' (' + value.substring(1, 4);
                    }
                    if (value.length >= 5) {
                        formatted += ') ' + value.substring(4, 7);
                    }
                    if (value.length >= 8) {
                        formatted += '-' + value.substring(7, 9);
                    }
                    if (value.length >= 10) {
                        formatted += '-' + value.substring(9, 11);
                    }
                    e.target.value = formatted;
                }
            });

            const charityInitial = document.getElementById('charityInitial');
            const introForm = document.getElementById('introForm');
            const postsList = document.getElementById('postsList');
            const postsContainer = document.getElementById('postsContainer');
            const postDetail = document.getElementById('postDetail');

            const wantToHelpBtn = document.getElementById('wantToHelpBtn');
            const needHelpBtn = document.getElementById('needHelpBtn');
            const helperForm = document.getElementById('helperForm');
            const backToButtons = document.getElementById('backToButtons');

            // Check if user already introduced
            const helperName = getFromLocalStorage('helperName');
            if (helperName) {
                charityInitial.style.display = 'none';
                introForm.style.display = 'none';
                postsList.style.display = 'block';
                renderPosts();
            }

            wantToHelpBtn.addEventListener('click', () => {
                charityInitial.style.display = 'none';
                introForm.style.display = 'block';
            });

            needHelpBtn.addEventListener('click', () => {
                alert('–§—É–Ω–∫—Ü–∏—è "–ú–Ω–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å" –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.');
            });

            helperForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('helperName').value;
                saveToLocalStorage('helperName', name);
                
                introForm.style.display = 'none';
                postsList.style.display = 'block';
                renderPosts();
            });

            backToButtons.addEventListener('click', () => {
                postsList.style.display = 'none';
                charityInitial.style.display = 'block';
            });

            function renderPosts() {
                postsContainer.innerHTML = '';
                charityPosts.forEach(post => {
                    const postCard = document.createElement('div');
                    postCard.className = 'post-card';
                    postCard.innerHTML = `
                        <img src="${post.image}" alt="${post.title}" class="post-image">
                        <div class="post-content">
                            <div class="post-author">
                                <img src="${post.avatar}" alt="${post.authorName}" class="post-avatar">
                                <div class="post-author-info">
                                    <div class="post-author-name">${post.authorName}</div>
                                </div>
                            </div>
                            <h3 class="post-title">${post.title}</h3>
                            <p class="post-amount">${post.amount.toLocaleString('ru-RU')} ‚ÇΩ</p>
                        </div>
                    `;
                    postCard.addEventListener('click', () => openPostDetail(post));
                    postsContainer.appendChild(postCard);
                });
            }

            function openPostDetail(post) {
                currentPost = post;
                document.getElementById('detailImage').src = post.image;
                document.getElementById('detailAuthorAvatar').src = post.avatar;
                document.getElementById('detailAuthorName').textContent = post.authorName;
                document.getElementById('detailTitle').textContent = post.title;
                document.getElementById('detailDescription').textContent = post.description;
                document.getElementById('detailAmount').textContent = post.amount.toLocaleString('ru-RU') + ' ‚ÇΩ';
                document.getElementById('detailRecipient').textContent = post.recipient;
                document.getElementById('detailBank').textContent = post.bank;
                document.getElementById('detailPhone').textContent = post.phone; // Changed to phone
                
                const detailSlider = document.getElementById('detailDonationSlider');
                detailSlider.max = post.amount;
                detailSlider.value = 0;
                document.getElementById('detailDonationValue').textContent = '0 ‚ÇΩ';
                
                document.getElementById('receiptUpload').classList.remove('active');
                document.getElementById('receiptPreview').classList.remove('active');
                document.getElementById('submitReceipt').style.display = 'none';
                
                // Check if donation is confirmed
                const donations = getFromLocalStorage('donations') || [];
                const postDonations = donations.filter(d => d.postId === post.id);
                const confirmedDonation = postDonations.find(d => d.confirmed);

                if (confirmedDonation) {
                    document.getElementById('openChatBtn').classList.add('active');
                } else {
                    document.getElementById('openChatBtn').classList.remove('active');
                }
                
                postDetail.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            document.getElementById('closeDetail').addEventListener('click', () => {
                postDetail.classList.remove('active');
                document.body.style.overflow = 'auto';
                currentPost = null;
            });

            postDetail.addEventListener('click', (e) => {
                if (e.target === postDetail) {
                    postDetail.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    currentPost = null;
                }
            });

            // Donation sliders
            const donationSlider = document.getElementById('donationSlider');
            const donationValue = document.getElementById('donationValue');

            donationSlider.addEventListener('input', (e) => {
                donationValue.textContent = parseInt(e.target.value).toLocaleString('ru-RU') + ' ‚ÇΩ';
            });

            const detailDonationSlider = document.getElementById('detailDonationSlider');
            const detailDonationValue = document.getElementById('detailDonationValue');

            detailDonationSlider.addEventListener('input', (e) => {
                detailDonationValue.textContent = parseInt(e.target.value).toLocaleString('ru-RU') + ' ‚ÇΩ';
            });

            document.getElementById('donateBtn').addEventListener('click', () => {
                const amount = donationSlider.value;
                if (amount > 0) {
                    const donations = getFromLocalStorage('donations') || [];
                    donations.push({
                        amount: parseInt(amount),
                        date: new Date().toISOString(),
                        type: 'general'
                    });
                    saveToLocalStorage('donations', donations);
                    alert(`–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–µ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ ${parseInt(amount).toLocaleString('ru-RU')} ‚ÇΩ!`);
                    donationSlider.value = 0;
                    donationValue.textContent = '0 ‚ÇΩ';
                } else {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É–º–º—É –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è');
                }
            });

            document.getElementById('detailDonateBtn').addEventListener('click', () => {
                const amount = detailDonationSlider.value;
                if (amount > 0) {
                    const donations = getFromLocalStorage('donations') || [];
                    const donation = {
                        amount: parseInt(amount),
                        date: new Date().toISOString(),
                        postId: currentPost.id,
                        confirmed: false,
                        receipt: null
                    };
                    donations.push(donation);
                    saveToLocalStorage('donations', donations);
                    
                    // Show receipt upload
                    document.getElementById('receiptUpload').classList.add('active');
                    alert(`–°–ø–∞—Å–∏–±–æ! –¢–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∑–∏—Ç–µ —á–µ–∫ –æ –ø–µ—Ä–µ–≤–æ–¥–µ ${parseInt(amount).toLocaleString('ru-RU')} ‚ÇΩ`);
                } else {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É–º–º—É –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è');
                }
            });

            const uploadArea = document.getElementById('uploadArea');
            const receiptInput = document.getElementById('receiptInput');
            const receiptPreview = document.getElementById('receiptPreview');
            const submitReceipt = document.getElementById('submitReceipt');

            uploadArea.addEventListener('click', () => {
                receiptInput.click();
            });

            receiptInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        receiptPreview.src = event.target.result;
                        receiptPreview.classList.add('active');
                        submitReceipt.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });

            submitReceipt.addEventListener('click', () => {
                const donations = getFromLocalStorage('donations') || [];
                const lastDonation = donations.find(d => d.postId === currentPost.id && !d.confirmed);
                if (lastDonation) {
                    lastDonation.receipt = receiptPreview.src;
                    // Simulate operator confirmation
                    setTimeout(() => {
                        lastDonation.confirmed = true;
                        saveToLocalStorage('donations', donations);
                        alert('–ß–µ–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –æ–±—â–∞—Ç—å—Å—è —Å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º –≤ —á–∞—Ç–µ.');
                        document.getElementById('openChatBtn').classList.add('active');
                        document.getElementById('receiptUpload').classList.remove('active');
                        confirmReceipt(currentPost.id); // Add to active chats and render list
                    }, 2000);
                    
                    alert('–ß–µ–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É. –û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è...');
                }
            });

            // UPDATED CHAT FUNCTIONALITY TO WORK WITH CHATS TAB
            const chatsList = document.getElementById('chatsList');
            const emptyChats = document.getElementById('emptyChats');
            const closeChat = document.getElementById('closeChat');
            const chatMessages = document.getElementById('chatMessages');
            const chatInput = document.getElementById('chatInput');
            const sendMessage = document.getElementById('sendMessage');
            const chatAttachment = document.getElementById('chatAttachment');
            const emojiButtons = document.querySelectorAll('.emoji-btn');
            let pendingAttachment = null; // Variable to hold attachment data before sending
            let currentPost = null; // Holds the current post data for detail view
            let currentChatPost = null; // Holds the current post data for chat view

            // Helper function to get data from localStorage
            function getFromLocalStorage(key) {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            }

            // Helper function to save data to localStorage
            function saveToLocalStorage(key, value) {
                localStorage.setItem(key, JSON.stringify(value));
            }


            function formatChatDate(date) {
                const today = new Date();
                const messageDate = new Date(date);
                
                today.setHours(0, 0, 0, 0);
                messageDate.setHours(0, 0, 0, 0);
                
                const diffTime = today - messageDate;
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays === 0) {
                    return '–°–µ–≥–æ–¥–Ω—è';
                } else if (diffDays === 1) {
                    return '–í—á–µ—Ä–∞';
                } else {
                    return messageDate.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' });
                }
            }

            function formatMessageTime(date) {
                return new Date(date).toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            }

            function hasUnreadMessages() {
                const chats = getFromLocalStorage('activeChats') || [];
                for (const chat of chats) {
                    const messages = getFromLocalStorage(`chat_${chat.postId}`) || [];
                    const unreadCount = messages.filter(m => !m.isOwn && !m.read).length;
                    if (unreadCount > 0) return true;
                }
                return false;
            }

            function updateNotificationBadge() {
                const badge = document.getElementById('chatsNotificationBadge');
                if (hasUnreadMessages()) {
                    badge.style.display = 'block';
                } else {
                    badge.style.display = 'none';
                }
            }
            
            function renderChatsList() {
                const chats = getFromLocalStorage('activeChats') || [];
                chatsList.innerHTML = '';
                
                if (chats.length === 0) {
                    emptyChats.style.display = 'block';
                    chatsList.style.display = 'none';
                } else {
                    emptyChats.style.display = 'none';
                    chatsList.style.display = 'flex';
                    
                    chats.forEach(chat => {
                        const post = charityPosts.find(p => p.id === chat.postId);
                        if (!post) return;
                        
                        const messages = getFromLocalStorage(`chat_${post.id}`) || [];
                        const unreadCount = messages.filter(m => !m.isOwn && !m.read).length;
                        
                        let lastMessageText = '–ù–∞—á–Ω–∏—Ç–µ –¥–∏–∞–ª–æ–≥';
                        if (messages.length > 0) {
                            const lastMsg = messages[messages.length - 1];
                            if (lastMsg.text) {
                                lastMessageText = lastMsg.text.length > 50 ? lastMsg.text.substring(0, 50) + '...' : lastMsg.text;
                            } else if (lastMsg.attachment) {
                                lastMessageText = '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';
                            }
                        }
                        
                        const chatItem = document.createElement('div');
                        chatItem.className = 'chat-item';
                        chatItem.innerHTML = `
                            <img src="${post.avatar}" alt="" class="chat-item-avatar">
                            <div class="chat-item-info">
                                <div class="chat-item-name">${post.authorName}</div>
                                <div class="chat-item-last-message">${lastMessageText}</div>
                            </div>
                            ${unreadCount > 0 ? '<span class="chat-item-notification"></span>' : ''}
                        `;
                        
                        chatItem.addEventListener('click', () => {
                            openChatInTab(post);
                        });
                        
                        chatsList.appendChild(chatItem);
                    });
                }
                
                updateNotificationBadge();
            }

            function openChatInTab(post) {
                currentChatPost = post;
                
                document.getElementById('chatsListView').classList.add('hidden');
                document.getElementById('chatView').classList.add('active');
                
                document.getElementById('chatRecipientAvatar').src = post.avatar;
                document.getElementById('chatRecipientName').textContent = post.authorName;
                
                renderMessages(post.id);
                
                // Mark messages as read
                const messages = getFromLocalStorage(`chat_${post.id}`) || [];
                messages.forEach(m => {
                    if (!m.isOwn) m.read = true;
                });
                saveToLocalStorage(`chat_${post.id}`, messages);
                updateNotificationBadge();
            }

            document.getElementById('chatBackBtn').addEventListener('click', () => {
                document.getElementById('chatView').classList.remove('active');
                document.getElementById('chatsListView').classList.remove('hidden');
                renderChatsList();
            });

            function renderMessages(postId) {
                const messages = getFromLocalStorage(`chat_${postId}`) || [];
                chatMessages.innerHTML = '';
                
                let lastDate = null;
                
                messages.forEach((msg, index) => {
                    const messageDate = formatChatDate(msg.timestamp);
                    
                    if (messageDate !== lastDate) {
                        const dateSeparator = document.createElement('div');
                        dateSeparator.className = 'chat-date-separator';
                        dateSeparator.innerHTML = `<span class="chat-date-text">${messageDate}</span>`;
                        chatMessages.appendChild(dateSeparator);
                        lastDate = messageDate;
                    }
                    
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `chat-message ${msg.isOwn ? 'own' : ''}`;
                    
                    const post = charityPosts.find(p => p.id === postId);
                    const avatarSrc = msg.isOwn ? (getFromLocalStorage('userProfile')?.photo || '/placeholder.svg') : post.avatar;
                    
                    let messageContent = `
                        <img src="${avatarSrc}" alt="" class="message-avatar">
                        <div>
                            <div class="message-bubble">
                                <div class="message-text">${msg.text || ''}</div>
                                ${msg.attachment ? `<img src="${msg.attachment}" class="message-attachment">` : ''}
                                <div class="message-time">${formatMessageTime(msg.timestamp)}${msg.edited ? ' (—Ä–µ–¥.)' : ''}</div>
                            </div>
                            ${msg.isOwn ? `
                            <div class="message-actions">
                                <button class="message-edit-btn" onclick="editMessage(${postId}, ${index})">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                            </div>
                            ` : ''}
                        </div>
                    `;
                    
                    messageDiv.innerHTML = messageContent;
                    chatMessages.appendChild(messageDiv);
                });
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            window.editMessage = function(postId, messageIndex) {
                const messages = getFromLocalStorage(`chat_${postId}`) || [];
                const message = messages[messageIndex];
                
                if (!message.isOwn) return;
                
                const newText = prompt('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:', message.text);
                if (newText !== null && newText.trim() !== '') {
                    message.text = newText.trim();
                    message.edited = true;
                    saveToLocalStorage(`chat_${postId}`, messages);
                    renderMessages(postId);
                }
            };

            document.getElementById('sendMessage').addEventListener('click', () => {
                if (!currentChatPost) return;
                
                const input = chatInput;
                const text = input.value.trim();
                
                if (text || pendingAttachment) {
                    const messages = getFromLocalStorage(`chat_${currentChatPost.id}`) || [];
                    messages.push({
                        text: text,
                        attachment: pendingAttachment,
                        isOwn: true,
                        timestamp: new Date().toISOString(),
                        read: true,
                        edited: false
                    });
                    saveToLocalStorage(`chat_${currentChatPost.id}`, messages);
                    
                    input.value = '';
                    pendingAttachment = null; // Clear pending attachment
                    renderMessages(currentChatPost.id);
                }
            });

            chatAttachment.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        pendingAttachment = event.target.result;
                        // Optionally display a preview or confirmation here
                        console.log("Attachment ready to send.");
                    };
                    reader.readAsDataURL(file);
                }
            });

            emojiButtons.forEach(button => {
                button.addEventListener('click', () => {
                    chatInput.value += button.dataset.emoji;
                });
            });

            function showPostDetail(postId) {
                const post = charityPosts.find(p => p.id === postId);
                if (!post) return;
                
                currentPost = post;
                document.getElementById('detailImage').src = post.image;
                document.getElementById('detailAuthorAvatar').src = post.avatar;
                document.getElementById('detailAuthorName').textContent = post.authorName;
                document.getElementById('detailTitle').textContent = post.title;
                document.getElementById('detailDescription').textContent = post.description;
                document.getElementById('detailAmount').textContent = post.amount.toLocaleString('ru-RU') + ' ‚ÇΩ';
                document.getElementById('detailRecipient').textContent = post.recipient;
                document.getElementById('detailBank').textContent = post.bank;
                document.getElementById('detailPhone').textContent = post.phone; // Changed to phone
                
                const detailSlider = document.getElementById('detailDonationSlider');
                detailSlider.max = post.amount;
                detailSlider.value = 0;
                document.getElementById('detailDonationValue').textContent = '0 ‚ÇΩ';
                
                document.getElementById('receiptUpload').classList.remove('active');
                document.getElementById('receiptPreview').classList.remove('active');
                document.getElementById('submitReceipt').style.display = 'none';
                
                const donations = getFromLocalStorage('donations') || [];
                const postDonations = donations.filter(d => d.postId === post.id);
                const confirmedDonation = postDonations.find(d => d.confirmed);

                if (confirmedDonation) {
                    document.getElementById('openChatBtn').classList.add('active');
                } else {
                    document.getElementById('openChatBtn').classList.remove('active');
                }
                
                postDetail.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            // Event listener for opening chat from detail view
            document.getElementById('openChatBtn').addEventListener('click', () => {
                if (currentPost) {
                    openChatInTab(currentPost);
                }
            });

            // Function to confirm receipt and add to active chats
            function confirmReceipt(postId) {
                const activeChats = getFromLocalStorage('activeChats') || [];
                if (!activeChats.find(chat => chat.postId === postId)) {
                    activeChats.push({ postId: postId, startDate: new Date().toISOString() });
                    saveToLocalStorage('activeChats', activeChats);
                    
                    // Initialize chat with welcome message
                    const post = charityPosts.find(p => p.id === postId);
                    if (post) {
                        const messages = getFromLocalStorage(`chat_${postId}`) || [];
                        if (messages.length === 0) {
                            const now = new Date();
                            messages.push({
                                text: '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–ø–∞—Å–∏–±–æ –±–æ–ª—å—à–æ–µ –∑–∞ –ø–æ–º–æ—â—å! üôè',
                                time: formatMessageTime(now),
                                timestamp: now.toISOString(),
                                isOwn: false,
                                read: false
                            });
                            saveToLocalStorage(`chat_${postId}`, messages);
                        }
                    }
                    renderChatsList(); // Update the list of chats
                }
            }

            // Update notification badge on page load
            updateNotificationBadge();

            // Render initial chats list if 'chats' tab is active on load
            if (document.getElementById('chats').classList.contains('active')) {
                renderChatsList();
            }

        }); // End of DOMContentLoaded wrapper

    </script>
</body>
</html>
